
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2. Importance sampling (Markov Chain Monte Carlo) &#8212; Metodi di Simulazione Applicati alla Fisica</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/lectures/importance_sampling';</script>
    <link rel="canonical" href="https://mattiasotgia.github.io/simulation-methods/content/lectures/importance_sampling.html" />
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Riferimenti bibliografici" href="../zbiblio.html" />
    <link rel="prev" title="1. Introduzione" href="introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Metodi di Simulazione Applicati alla Fisica - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Metodi di Simulazione Applicati alla Fisica - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lezioni</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduzione</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. Importance sampling (Markov Chain Monte Carlo)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Riferimenti bibliografici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../zbiblio.html">Riferimenti bibliografici</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contatti esterni</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://mattiasotgia.github.io/">Mattia Sotgia</a></li>
<li class="toctree-l1"><a class="reference external" href="https://twitter.com/mattiasotgia1">@mattiasotgia1 (twitter)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/lectures/importance_sampling.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Importance sampling (Markov Chain Monte Carlo)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#catene-di-markov">2.1. Catene di Markov</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#teorema-della-probabilita-congiunta">2.1.1. Teorema della probabilità congiunta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-con-importance-sampling">2.1.2. Monte Carlo con <em>importance sampling</em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algoritmo-di-metropolis">2.2. Algoritmo di Metropolis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modello">2.2.1. Modello</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ma-quindi-cosa-andiamo-a-studiare">2.2.1.1. Ma quindi cosa andiamo a studiare?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="importance-sampling-markov-chain-monte-carlo">
<h1><span class="section-number">2. </span>Importance sampling (Markov Chain Monte Carlo)<a class="headerlink" href="#importance-sampling-markov-chain-monte-carlo" title="Link to this heading">#</a></h1>
<p>(23 febbraio 2024)</p>
<p>Vogliamo calcolare nella pratica fenomeni di danneggiamento in reattori nucleari. Nasce questo in ambito <em>Los Alamos</em>, ovvero sullo studio della fissione nucleare. Il problema principale era quello di risolvere integrali in domini di dimensionalità molto elevata. In questi casi, algoritmi come <em>simpson</em> o il metodo dei trapezi fallisce rapidamente. Infatti data una dimensione <span class="math notranslate nohighlight">\(D\)</span>, campionando 10 punti (8 punti interni al dominio) si ha che il dominio di integrazione corrisponde in percentuale a</p>
<div class="math notranslate nohighlight">
\[
    \left(\frac{8}{10}\right)^D \to 0 \quad \text{per $D$ grandi.}
\]</div>
<p>Quindi vediamo che è necessario trovare una soluzione alternativa, che permetta di non avere zeri o divergenze.</p>
<p>Chiamiamo i punti dello spazio <span class="math notranslate nohighlight">\(\bf x\)</span>, il dominio di integrazione <span class="math notranslate nohighlight">\(\Omega\)</span>, e ci troviamo in uno spazio di dimensione <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>Considerando una funzione su questo dominio, allora potremo calcolarne il valore come</p>
<div class="math notranslate nohighlight">
\[
    \int_\Omega A({\bf x}) d {\bf x}
\]</div>
<p>Consideriamo una probabilità <span class="math notranslate nohighlight">\(p({\bf x})\)</span>, tale che questa è normalizzata a 1 e definita positiva. ridefinisco l’integrale precedente come</p>
<div class="math notranslate nohighlight">
\[
    I = \int_\Omega \frac{A({\bf x})}{p({\bf x})} p({\bf x}) d {\bf x} = \int_\Omega G({\bf x}) p({\bf x}) d {\bf x}.
\]</div>
<p>Mi accorgo facilmente che questo corrisponde a voler calcolare il valor medio di <span class="math notranslate nohighlight">\(G\)</span> secondo la distribuzione di probabilità <span class="math notranslate nohighlight">\(p\)</span>. L’idea che allora mi viene in mente è quello di campionare lo spazio delle <span class="math notranslate nohighlight">\(\bf x\)</span> propozionalmente a <span class="math notranslate nohighlight">\(p\)</span>, lo campiono <span class="math notranslate nohighlight">\(M\)</span> volte, <span class="math notranslate nohighlight">\({\bf x_i}\)</span>, <span class="math notranslate nohighlight">\(i=1, 2,\dots,M\)</span>. Se ho campionato in modo corretto ottengo che</p>
<div class="math notranslate nohighlight">
\[
    I\simeq \frac1M \sum_{i=1}^M G({\bf x_i}) = \frac1M \sum_{i=1}^M \frac{A({\bf x_i})}{p({\bf x_i})}
\]</div>
<p>Allora l’obiettivo principale è quello di identificare una <span class="math notranslate nohighlight">\(p\)</span> adeguata ad ottimizzare e rendere più vera possibile questa uguaglianza. La prima (e anche più semplice) scelta che mi viene è quella di considerare una distribuzione uniforme. Otteniamo allora che</p>
<div class="math notranslate nohighlight">
\[
    I\simeq \frac VM \sum_{i=1}^M A({\bf x_i}).
\]</div>
<section id="catene-di-markov">
<h2><span class="section-number">2.1. </span>Catene di Markov<a class="headerlink" href="#catene-di-markov" title="Link to this heading">#</a></h2>
<p>Il modello precedente può essere molto migliorato. Abbiamo innanzitutto compreso che</p>
<ol class="arabic simple">
<li><p>Lo spazio sarà a molte dimensione (tratteremo lo spazio delle fasi secondo la meccanica lagrangiana e hamiltoniana, quindi con un numero enorme di dimensioni)</p></li>
<li><p>Dovremo avere probabilità che in realtà non sono casuali, ma funzioni <span class="math notranslate nohighlight">\(p({\bf x})\)</span> fornite dalla fisica.</p></li>
</ol>
<p>Vedremo quindi quella che prende il nome dei teoria delle catene di Markov. La tratteremo nel suo formalismo (semi) completo. Rinunceremo però a considerare spazi infiniti, ma avremmo uno spazio delle fasi <strong>discreto</strong> e <strong>finito</strong>. Questo ha molto senso perché il calcolo numerico è comunque un calcolo discreto e finito.</p>
<p>Consideriamo un insieme di <span class="math notranslate nohighlight">\(\mathcal S\)</span> stati, e l’indice sarà <span class="math notranslate nohighlight">\(i = 1, \dots, \mathcal S\)</span>. Su questo spazio di stati compieremo una <strong>catena di estrazioni</strong>. Ogni estrazione corrispondere a scegliere uno degli stati del sistema, e si tratta di estrazioni con re-immissione. Consideriamo <span class="math notranslate nohighlight">\(0, \dots, M\)</span> estrazioni, che sommeranno ad un totale di <span class="math notranslate nohighlight">\(M+1\)</span> estrazioni totali.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Senza dimostrarlo formalmente, è intuitivo capire che queste estrazioni sono in realtà indipendenti (ovvero scorrelate) e equiprobabili.</p>
</aside>
<p>Nonostante le Markov Chains siano scorrelate, quello che in realtà a noi serve è una catena correlata (sarebbe troppo semplice), e vogliamo che per motivi di utilizzazione pratica questa correlazione sia la più semplice possibile.</p>
<p>Nella catena di estrazioni estrarremo</p>
<div class="math notranslate nohighlight">
\[
    i_0, i_1, \dots, i_M.
\]</div>
<p>La descrizione di questa estrazione mi dice che esiste la probabilità <strong>congiunta</strong> a <span class="math notranslate nohighlight">\(M+1\)</span> valori</p>
<div class="math notranslate nohighlight">
\[
    p^{(M)} (i_0, i_1, \dots, i_M).
\]</div>
<p>In assenza di correlazioni avremo che</p>
<div class="math notranslate nohighlight">
\[
    p^{(M)} (i_0, i_1, \dots, i_M) = p^{(1)} (i_0) p^{(1)} (i_1) p^{(1)} (i_2) \dots p^{(1)} (i_M)
\]</div>
<p>Quello che invece voglio ottenere è di poter calcolare delle catene in cui l’estrazione è condizionata dai risultati precedenti. Non vorrei però che il risultato sia inlfuenzato da tutte le condizioni precedenti dall’inizio dei tempi, ma solo dalla condizione immediatamente precedente.</p>
<section id="teorema-della-probabilita-congiunta">
<h3><span class="section-number">2.1.1. </span>Teorema della probabilità congiunta<a class="headerlink" href="#teorema-della-probabilita-congiunta" title="Link to this heading">#</a></h3>
<div class="warning admonition">
<p class="admonition-title">Da sistemare</p>
<p>Appunti incompleti</p>
</div>
<p>È possibile esprimere la probabilità congiunta in termini di una probabilità condizionata</p>
<div class="math notranslate nohighlight">
\[
    p^{(M)} (i_0, i_1, \dots, i_M) = P_C^{(M)} (i_M | i_0, i_1, \dots, i_{M-1}) p^{(M-1)} (i_0, i_1, \dots, i_{M-1})
\]</div>
<p>Iterando allora ottengo che</p>
<div class="math notranslate nohighlight">
\[
    p^{(M)} (i_0, i_1, \dots, i_M) = 
    P_C^{(M)} (i_M | i_{M-1}) 
    P_C^{(M-1)} (i_{M-1} | i_{M-2}) 
    P_C^{(M-2)} (i_{M-2} | i_{M-3}) 
    \dots 
    P_C^{(1)} (i_{1} | i_{0}) 
    p^{(0)} (i_0)
\]</div>
<p>Se inoltre <span class="math notranslate nohighlight">\(P_C^{(m)}\)</span> ha la stessa forma indipendentemente da <span class="math notranslate nohighlight">\(m\)</span>, allora chiameremo questa catena una catena di Markov omogenea. Questo sarà il caso principale che tratteremo, ponendoci all’equilibrio termico.</p>
<div class="warning admonition">
<p class="admonition-title">Cambio di notazione</p>
<p>Da questo punto considereremo un cambio di notazione.</p>
<p>Chiamiamo la probabilità di estrarre lo stato <span class="math notranslate nohighlight">\(i\)</span> all’inizio come</p>
<div class="math notranslate nohighlight">
\[
    p^{(0)}(i_0) \to p_i ^{(0)}.
\]</div>
<p>Inoltre avremo che</p>
<div class="math notranslate nohighlight">
\[
    P_C^{(M)} (j | i) \to \pi_{ij}
\]</div>
<p>Con questa nuova notazione osserviamo che <span class="math notranslate nohighlight">\(p_i^{(0)}\)</span> è un vettore con <span class="math notranslate nohighlight">\(\mathcal S\)</span> componenti, mentre <span class="math notranslate nohighlight">\(\pi_{ij}\)</span> è una matrice di dimensione <span class="math notranslate nohighlight">\(\mathcal S \times \mathcal S\)</span>. Valgono in questa nuova notazione le condizioni</p>
<div class="math notranslate nohighlight">
\[
    \sum_{i=1}^{\mathcal S} p_i^{(0)} = 1 \quad \sum_{j=1}^{\mathcal S} \pi_{ij} = 1, 
\]</div>
<p>corrispondenti alla normalizzazione delle probabilità e anche delle probabilità di transizione.</p>
</div>
<p>Avremo che con questa nuova notazione la scrittura</p>
<div class="math notranslate nohighlight">
\[
    p^{(1)} (i_0, i_1) = P_C^{(1)} (i_1 | i_0) p^{(0)} (i_0) \to p_{ij}^{(1)} = p_i^{(0)} \pi _{ij},
\]</div>
<p>ovvero si semplifica notevolmente. MA allora se mi chiedo quale è la probabilità di estrarre lo stato <span class="math notranslate nohighlight">\(j\)</span> all’estrazione 1, questa sarà data da</p>
<div class="math notranslate nohighlight">
\[ 
    p_j^{(1)} = \sum_i p_i^{(0)} \pi _{ij},
\]</div>
<p>ovvero in notazione matriciale <span class="math notranslate nohighlight">\({\bf p}^{(1)} = {\bf p}^{(0)} \underline \pi\)</span>.</p>
<p>Iterando allora ottengo che <span class="math notranslate nohighlight">\(\vec p^{(m)} = \vec p^{(0)} \underline \pi^{m}\)</span>, che mi dice allora che</p>
<div class="math notranslate nohighlight">
\[ 
    \vec p^\text{eq} = \lim_{m\to\infty} \vec p^{(0)} \underline \pi^{m}.
\]</div>
<p>Osserviamo che per quanto detto in precedenza, allora tutte le probabilità saranno normalizzate ad uno.</p>
</section>
<section id="monte-carlo-con-importance-sampling">
<h3><span class="section-number">2.1.2. </span>Monte Carlo con <em>importance sampling</em><a class="headerlink" href="#monte-carlo-con-importance-sampling" title="Link to this heading">#</a></h3>
<p>Questometodo prevede di estrarre numeri per fare si che la distribuzione che si raggiunge sia la distribuzione di equilibrio, che vorremo essere in particolare per la fisica della materia distribuzione di Boltzmann. Questa la chiameremo <span class="math notranslate nohighlight">\(\vec p^\text{eq}\)</span>. Vorremmo che</p>
<div class="math notranslate nohighlight">
\[ 
    \vec p^\text{eq} = \lim_{m\to\infty} \vec p^{(0)} \underline \pi^{m}.
\]</div>
<p>a partire da ogni probabilità <span class="math notranslate nohighlight">\(p^{(0)}\)</span> di partenza. Questo vuol dire</p>
<ol class="arabic simple">
<li><p>Scegliere appropriamente una <span class="math notranslate nohighlight">\(p^{(0)}\)</span></p></li>
<li><p>Fare andare la macchina, in modo che campionando stati successivi siano estratti secondo la probabilità <span class="math notranslate nohighlight">\(p^\text{eq}\)</span>.</p></li>
</ol>
<p>Perché questo avvenga dovrò costruire la matrice <span class="math notranslate nohighlight">\(\pi\)</span> adeguatamente per avere l’efficenza massima (ovvero possibilmente per una convergenza rapida del limite).</p>
<p>Le possiibli soluzioni, ovvero le possibili <span class="math notranslate nohighlight">\(\pi\)</span> che soddisfano questo limite, sono effettivamente infinite, e quello che noi vorremo fare è di sceglierne una in particolare che rispetti i vincoli richiesti, ma che dia una soluzione semplice tra quelle a disposizione.</p>
<p>La <span class="math notranslate nohighlight">\(\pi\)</span> che costruiamo convergerà alla richiesta <span class="math notranslate nohighlight">\(\vec p^\text{eq}\)</span> se soddisfa richieste di</p>
<ol class="arabic simple">
<li><p>Ergodicità. Capacità di connettere stati diversi in un numero finito di passi successivi. Nel caso delle <span class="math notranslate nohighlight">\(\pi\)</span> vuol dire che a partire da ogni stato di partenza <span class="math notranslate nohighlight">\(p^{(0)}\)</span> sarà possibile raggiungere <span class="math notranslate nohighlight">\(\vec p^\text{eq}\)</span>.</p></li>
<li><p>Aperiodicità. Non si va ad intrappolare in cicli che non convergono.</p></li>
</ol>
<p>Date queste condizioni, quello che succede è che</p>
<p><strong>Teorema</strong>. Se <span class="math notranslate nohighlight">\(\pi\)</span> è <em>ergodica</em> e <em>aperiodica</em>, allora esiste <span class="math notranslate nohighlight">\(\vec p^*\)</span> tale che</p>
<div class="math notranslate nohighlight">
\[
    \lim_{m\to\infty} \vec p^{(0)} \pi^m = \vec p^*,
\]</div>
<p>per ogni <span class="math notranslate nohighlight">\(\vec p^{(0)}\)</span>.</p>
<p>Vogliamo che <span class="math notranslate nohighlight">\(\vec p^\text{eq} = \vec p^*\)</span>. Per avere ciò è necessario scegliere <span class="math notranslate nohighlight">\(\pi\)</span> per cui <span class="math notranslate nohighlight">\(\vec p^\text{eq} \pi = \vec p^\text{eq}\)</span>. Infatti così ho che</p>
<div class="math notranslate nohighlight">
\[
    \vec p^\text{eq} \pi^m = \vec p^\text{eq} \implies \lim_{m\to\infty}\vec p^\text{eq} \pi = \vec p^\text{eq} \implies \text{Q.E.D.}
\]</div>
<p>Voglio costruire ora la <span class="math notranslate nohighlight">\(\pi\)</span>. Per fare ciò voglio introdurre il <strong>bilancio dettagliato</strong>. Questo implica una scelta di <span class="math notranslate nohighlight">\(\pi\)</span> data da</p>
<div class="math notranslate nohighlight">
\[
    \vec p^\text{eq}_{i} \pi_{ij} = \vec p^\text{eq}_{j} \pi_{ji}.
\]</div>
<p>Questo corrisponde ad una conservazione del flusso. La transizione <span class="math notranslate nohighlight">\(i\to j\)</span> è equivalente a <span class="math notranslate nohighlight">\(j\to i\)</span>.</p>
<p>Per trovare allora la forma di <span class="math notranslate nohighlight">\(\pi\)</span> possiamom considerare le somme su <span class="math notranslate nohighlight">\(i\)</span>, ovvero</p>
<div class="math notranslate nohighlight">
\[
    \sum_i \vec p^\text{eq}_{i} \pi_{ij} = \sum_i \vec p^\text{eq}_{j} \pi_{ji} = \vec p^\text{eq}_{j} \sum_i \pi_{ji} = \vec p^\text{eq}_{j}.
\]</div>
</section>
</section>
<section id="algoritmo-di-metropolis">
<h2><span class="section-number">2.2. </span>Algoritmo di Metropolis<a class="headerlink" href="#algoritmo-di-metropolis" title="Link to this heading">#</a></h2>
<p>Differenziamo tra elementi non diagonali e gli elementi diagonali.</p>
<ul>
<li><p>Elementi off-diagonal.</p>
<div class="math notranslate nohighlight">
\[
       \vec p^\text{eq}_{j} &lt; \vec p^\text{eq}_{j} \implies \pi_{ij} = \alpha_{ij} \frac{\vec p^\text{eq}_{j}}{\vec p^\text{eq}_{i}}
   \]</div>
<p>Dove <span class="math notranslate nohighlight">\(\alpha_{ij}\)</span> è una matrice simmetrica, e</p>
<div class="math notranslate nohighlight">
\[
       \vec p^\text{eq}_{j} \geq \vec p^\text{eq}_{j} \implies \pi_{ij} = \alpha_{ij}
   \]</div>
</li>
<li><p>Elementi diagonal</p>
<div class="math notranslate nohighlight">
\[
       \pi_{ij} = 1 - \sum_{k\neq i} \pi_{ik}
   \]</div>
</li>
</ul>
<p>Questa scelta soddisfa il bilancio dettagliato.</p>
<section id="modello">
<h3><span class="section-number">2.2.1. </span>Modello<a class="headerlink" href="#modello" title="Link to this heading">#</a></h3>
<p>Il modello che andiamo a studiare è sufficentemente semplice, ma che comporta alcune sottigliezze.</p>
<p>Consideraimo <span class="math notranslate nohighlight">\(N\)</span> spin. Avenso spin <span class="math notranslate nohighlight">\(\frac12\)</span> allora gli stati sono <span class="math notranslate nohighlight">\(S=2^N\)</span>. la configurazione singola è data da <span class="math notranslate nohighlight">\(s_i\)</span>, e l’insieme delle configurazioni è <span class="math notranslate nohighlight">\(\{s_i\}\)</span>.</p>
<p>Allora il valore medio di una funzione <span class="math notranslate nohighlight">\(G\)</span> è dato da</p>
<div class="math notranslate nohighlight">
\[
    \langle G \rangle = \frac1Z \sum{\{s_i\}} G(\{s_i\}) e^{-\beta \mathcal H (\{s_i\})} = \sum_{\{s_i\}} G(\{s_i\}) p(\{s_i\}),
\]</div>
<p>dove</p>
<div class="math notranslate nohighlight">
\[
    p(\{s_i\}) = \frac1Z e^{-\beta \mathcal H}
\]</div>
<p>Gli addendi significativi della somma del valore di aspettazione sono i valori in cui si ha l’energia bassa, in quanto per energia alta questi sono pesati su una probabilità molto bassa (che va con energie all’esponente). Questo sembra un problema che è perfetto da risolvere con un algoritmo di importance sampling.</p>
<section id="ma-quindi-cosa-andiamo-a-studiare">
<h4><span class="section-number">2.2.1.1. </span>Ma quindi cosa andiamo a studiare?<a class="headerlink" href="#ma-quindi-cosa-andiamo-a-studiare" title="Link to this heading">#</a></h4>
<p>Studiaremo un sistema che è detto di <em>gas reticolare</em>. Consideriammo un array di SITI (<span class="math notranslate nohighlight">\(M\)</span> siti, con <span class="math notranslate nohighlight">\(M = \ell \times \ell\)</span>). Considero <span class="math notranslate nohighlight">\(N\)</span> siti degli <span class="math notranslate nohighlight">\(M\)</span> a disposizione (<span class="math notranslate nohighlight">\(N&lt;M\)</span>) occupati da particelle.</p>
<p>Fissata la configurazione iniziale, quello che vogliamo ottenere è di poter passare da una configurazione alla configurazione successiva. Quello che ci serve è quindi una regola, che sarà quella che verrà rappresentata dalla <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>Definiamo allora la regola.</p>
<ul>
<li><p>Considero una temepratura <span class="math notranslate nohighlight">\(T\)</span> iniziale.</p></li>
<li><p>Queste particelle interagiscono, con una intensità <span class="math notranslate nohighlight">\(\mathcal H \propto J\)</span>. L’interazione è fatta in modo che due particelle prime vicine possano scambiare una particella. L’interazione sarà data da
$<span class="math notranslate nohighlight">\(
    j \sum (\text{coppie di primi vicini}).
\)</span>$</p>
<p>Nel contare le coppie di primi vicini devo considerare che le condizioni al contorno spesso saaranno fissate periodiche.</p>
</li>
</ul>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="introduction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Introduzione</p>
      </div>
    </a>
    <a class="right-next"
       href="../zbiblio.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Riferimenti bibliografici</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#catene-di-markov">2.1. Catene di Markov</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#teorema-della-probabilita-congiunta">2.1.1. Teorema della probabilità congiunta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-con-importance-sampling">2.1.2. Monte Carlo con <em>importance sampling</em></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algoritmo-di-metropolis">2.2. Algoritmo di Metropolis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modello">2.2.1. Modello</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ma-quindi-cosa-andiamo-a-studiare">2.2.1.1. Ma quindi cosa andiamo a studiare?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mattia Sotgia
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://mattiasotgia.github.io/simulation-methods">Metodi di Simulazione Applicati alla Fisica</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://mattiasotgia.github.io">Mattia Sotgia</a> is licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>